<bi:biapp bi:version="1302" xmlns:bi="http://xml.sap.com/2011/biml/biapp" xmlns:jsp="http://java.sun.com/JSP/Page" xmlns="http://www.w3.org/TR/REC-html40" xmlns:h="http://www.w3.org/TR/REC-html40" xmlns:sdk1="org.kalisz.karol.scn.pack" sdk1:version="1.0">
	<bi:component name="APPLICATION_PROPERTIES" type="APPLICATION_PROPERTIES">
		<bi:property name="THEME" value="sap_platinum"/>
	</bi:component>
	<bi:data_source_alias name="DS_1" type="QUERY_DATA_SOURCE">
		<bi:property name="DATA_SOURCE_DEFINITION">
			<bi:property name="DATA_SOURCE_CONNECTION" value="Q93 [PUBLIC]"/>
			<bi:property name="DATA_SOURCE_TYPE" type="CHOICE" value="QUERY"/>
			<bi:property name="DATA_SOURCE_NAME" value="0BICS_009_BICSTEST_Q0007"/>
			<bi:property name="DATA_SOURCE_INITIAL_STATE">
				<bi:value><![CDATA[eNrtWm1v4jgQ/iuI76fQQtWrlI1knAn41olT2wHS08niWm4P6ZaeWvbD3a+/ySsJDRRaet2tUqEq9tjj8TzP2DMEe8ioMhMGU8dWICeMgnFBUclCzUSAnbHS4BvCGVHO9VW/82sYDTmjv9lWTWS7RBNDJBDHBY9EXNvWputwNdcRyNjppWb1elcmedCgtLnu9XqXtpXJcVaTsSzwhAmlmDAXZGc1/7r41C1Vda1c+7Zga40u7iVCxUSDc947G/Suzs5xL0VXaYICDjRZ16iQoCVKSM2CUWf9z9+oPXdCsmhloEYNBw+sdORjKZFoJyNBskk3ohptpWMiCdUgmdK4j+2OcrPUhCDVWbeiVeGaVn34vum45AunD7zpz3QQXvUH04t+n19MB0H/lwsigmfVWU+2Z5UTqs+Fx47wRr6dCVMRcu+GpGo4TIBvGNwktInWkg0jRKLyXNFMBX+RXh/8IUhDKAWFqkMJCgKdDtlqOhpmqKXWVW/ihGaapYqwwQJwTbaiMkJivKD7XSZz1xJFIXBxOjK/7ER/ZzrxacvYCig1Mzq/L1d3y9WXT93ahITtVSBppLTwTYhY+YBgJVxANWiwUaBf74sNZMnCVc1WKWoGcyRF1KL5UdD0iW7B/ChghpLRt0bTZSrkJDafIW5BPdolL8d2CmzUYvvjY2tVk6Wa2Z2v93foy6EQn9F7E8IjUN03sK7y7BSnRjP9nOK+3yPG3G6PFK+XPdKE07ud871TrI73M3wbM5BE0nHcufu2cOfrJKrzv24e5d0aLXewIR+Akc6GjDMdO+kjh5JxFdFhWzkR498Wrlo4vbrEavOdVx6fR9O5iblj5roQnIy47+/36nY9If2Ik0IdKqIC7WCBSiLLY6MIRzvrh28L5HODxL4BKYyKwmQHKmFichCHyULZpN3yY77CyL8BOX3NT0bQpisfMxUdCx/aQ/SjFI2K8DZQP2Cg0khKCGjcRuqPGKknLRObzDp9HZlcC3uKPUwIdkkLqu6ZjadUWyl+Z5Xi29DqfUvJp6/XmjByJePcuGIamK3xu99lZues2X73iXWCqVp04jec7/GK8pXvW595w3mgH8ksPaFmTOUGSDFNGFyGFwpx/gScP+Z/PWI9lbdybLN7sIccqjRtqzJbxT7yQTJqsiG+cEtdjbIiIkOhWLqXodDIrJKQZf/T0i+dH4gAGsq+TPeTbvykvzbAGJMx/icY+W7WRYFztauKfHbec+xzSqRfGl1WgloNOyp45AfN8GX7aELvvEXvePR2hv3p0PQkQBuJ/1ckJjfAK7GzssN0s3TncfllFT4sHher9Xy9vF9h+gF4AoMJouRe7nb+XTzc1wcEQvppqVmqKRLbMsPt3P45f5jfrhcPy8f18nbfHVS7pKYzvz+O+PXAP4tDT19egZdm9aV6FyjDxZXzE7qibNiKYuETjIyHjhAyFW512eCHY6LYDbgFoyo9tmKjAG+dCS5CeEm5WieurQnjBvXSiGfZT8afBkHDYLNJYjY/I9s3CoH0C325RZUem4Qhj02DBi3y+1OVcXjA0Fxf8m0n5olHqD1oRhGoT53XIGhmcIVtpyaeDPqXI94b9APv/Fzoa28W835LvJZ428Szaod2XuwaLUmgMhV5CVev60yCteHMZzq5/poF+SUpMOEiRUYNMwph0aACi6Ey1978uPU/qhxyFg==]]></bi:value>
			</bi:property>
		</bi:property>
	</bi:data_source_alias>
	<bi:component name="ROOT" type="ABSOLUTE_LAYOUT_COMPONENT">
		<bi:component name="COLLECTION_1" type="org_kalisz_karol_scn_pack_Collection"/>
		<bi:component name="CROSSTAB_1" type="CROSSTAB_COMPONENT">
			<bi:property name="LEFT_MARGIN" value="24"/>
			<bi:property name="TOP_MARGIN" value="106"/>
			<bi:property name="DATA_SOURCE_ALIAS_REF" value="DS_1"/>
			<bi:property name="HEIGHT" value="656"/>
			<bi:property name="WIDTH" value="475"/>
		</bi:component>
		<bi:component name="DIMENSIONFILTER_1" type="DIMENSIONFILTER_COMPONENT">
			<bi:property name="LEFT_MARGIN" value="27"/>
			<bi:property name="TOP_MARGIN" value="3"/>
			<bi:property name="DATA_SOURCE_ALIAS_REF" value="DS_1"/>
			<bi:property name="DIMENSION_NAME" value="0BC_PERS1"/>
		</bi:component>
		<bi:component name="BUTTON_2" type="BUTTON_COMPONENT">
			<bi:property name="TEXT" value="Get Top 10 by &quot;Umsatz&quot;"/>
			<bi:property name="LEFT_MARGIN" value="100"/>
			<bi:property name="TOP_MARGIN" value="49"/>
			<bi:property name="WIDTH" value="226"/>
			<bi:property name="ON_CLICK">
				<bi:value><![CDATA[var allMembers = DS_1.getMembers("0BC_PERS1", 9999);

var top1 = 0.0;
var top2 = 0.0;
var top3 = 0.0;
var top4 = 0.0;
var top5 = 0.0;

var top1CellInternalKey = "";
var top2CellInternalKey = "";
var top3CellInternalKey = "";
var top4CellInternalKey = "";
var top5CellInternalKey = "";

var top1CellMemberDescription = "";
var top2CellMemberDescription = "";
var top3CellMemberDescription = "";
var top4CellMemberDescription = "";
var top5CellMemberDescription = "";

// nothing will get back, but we have to initilize once

allMembers.forEach(function(member, index) {
  var memberKey = member.internalKey;
  var memberText = member.text;
  
   var dataCell = DS_1.getData("4FW8C4WXM3HULQ4M1YPFT79EF", {
  	"0BC_PERS1": memberKey
  });
  
  if(dataCell.formattedValue != "") {
  	var value = dataCell.value;
  	
  	// if bigger, move all
  	if(value > top1) {
  		top5 = top4;
		top4 = top3;
		top3 = top2;
		top2 = top1;
		top1 = value;

  		top5CellInternalKey = top4CellInternalKey;
		top4CellInternalKey = top3CellInternalKey;
		top3CellInternalKey = top2CellInternalKey;
		top2CellInternalKey = top1CellInternalKey;
		top1CellInternalKey = memberKey;

  		top5CellMemberDescription = top4CellMemberDescription;
		top4CellMemberDescription = top3CellMemberDescription;
		top3CellMemberDescription = top2CellMemberDescription;
		top2CellMemberDescription = top1CellMemberDescription;
		top1CellMemberDescription = memberText;
	}

  	// if bigger, move all
	else if(value > top2) {
  		top5 = top4;
		top4 = top3;
		top3 = top2;
		top2 = value;

  		top5CellInternalKey = top4CellInternalKey;
		top4CellInternalKey = top3CellInternalKey;
		top3CellInternalKey = top2CellInternalKey;
		top2CellInternalKey = memberKey;

  		top5CellMemberDescription = top4CellMemberDescription;
		top4CellMemberDescription = top3CellMemberDescription;
		top3CellMemberDescription = top2CellMemberDescription;
		top2CellMemberDescription = memberText;
  	}
  	
  	// if bigger, move all
	else if(value > top3) {
  		top5 = top4;
		top4 = top3;
		top3 = value;

  		top5CellInternalKey = top4CellInternalKey;
		top4CellInternalKey = top3CellInternalKey;
		top3CellInternalKey = memberKey;

  		top5CellMemberDescription = top4CellMemberDescription;
		top4CellMemberDescription = top3CellMemberDescription;
		top3CellMemberDescription = memberText;
  	}
  	
  	// if bigger, move all
	else if(value > top4) {
  		top5 = top4;
		top4 = value;

  		top5CellInternalKey = top4CellInternalKey;
		top4CellInternalKey = memberKey;

  		top5CellMemberDescription = top4CellMemberDescription;
		top4CellMemberDescription = memberText;
  	}
  	
  	// if bigger, move all
	else if(value > top5) {
  		top5 = value;

  		top5CellInternalKey = memberKey;

  		top5CellMemberDescription = memberText;
  	}
  }
});

LISTBOX_1.removeAllItems();
LISTBOX_1.addItem("NA", "here comes...");

if(top1 > 0.0) {
	var dataCell1 = DS_1.getData("4FW8C4WXM3HULQ4M1YPFT79EF", {
	  	"0BC_PERS1": top1CellInternalKey
  	});
  
	LISTBOX_1.addItem(top1CellInternalKey, top1CellMemberDescription + ": " + dataCell1.formattedValue + " ( float: " + Convert.floatToString(top1) + ") ");
}
if(top2 > 0.0) {
	var dataCell2 = DS_1.getData("4FW8C4WXM3HULQ4M1YPFT79EF", {
	  	"0BC_PERS1": top2CellInternalKey
  	});
  
	LISTBOX_1.addItem(top2CellInternalKey, top2CellMemberDescription + ": " + dataCell2.formattedValue + " ( float: " + Convert.floatToString(top2) + ") ");
}
if(top3 > 0.0) {
	var dataCell3 = DS_1.getData("4FW8C4WXM3HULQ4M1YPFT79EF", {
	  	"0BC_PERS1": top3CellInternalKey
  	});
  
	LISTBOX_1.addItem(top3CellInternalKey, top3CellMemberDescription + ": " + dataCell3.formattedValue + " ( float: " + Convert.floatToString(top3) + ") ");
}
if(top4 > 0.0) {
	var dataCell4 = DS_1.getData("4FW8C4WXM3HULQ4M1YPFT79EF", {
	  	"0BC_PERS1": top4CellInternalKey
  	});
  
	LISTBOX_1.addItem(top4CellInternalKey, top4CellMemberDescription + ": " + dataCell4.formattedValue + " ( float: " + Convert.floatToString(top4) + ") ");
}
if(top5 > 0.0) {
	var dataCell5 = DS_1.getData("4FW8C4WXM3HULQ4M1YPFT79EF", {
	  	"0BC_PERS1": top5CellInternalKey
  	});
  
	LISTBOX_1.addItem(top5CellInternalKey, top5CellMemberDescription + ": " + dataCell5.formattedValue + " ( float: " + Convert.floatToString(top5) + ") ");
}
]]></bi:value>
			</bi:property>
		</bi:component>
		<bi:component name="BUTTON_1" type="BUTTON_COMPONENT">
			<bi:property name="TEXT" value="Get Top 10 by &quot;Umsatz&quot; with Array"/>
			<bi:property name="LEFT_MARGIN" value="357"/>
			<bi:property name="TOP_MARGIN" value="46"/>
			<bi:property name="WIDTH" value="407"/>
			<bi:property name="ON_CLICK">
				<bi:value><![CDATA[var allMembers = DS_1.getMembers("0BC_PERS1", 9999);

var memberKeys = "";
var memberTexts = "";
var values = "";

allMembers.forEach(function(member, index) {
  var memberKey = member.internalKey;
  var memberText = member.text;
  
  var dataCell = DS_1.getData("4FW8C4WXM3HULQ4M1YPFT79EF", {
  	"0BC_PERS1": memberKey
  });
  
  if(dataCell.formattedValue != "") {
	var value = dataCell.value;
	
	memberTexts = memberTexts + "|" + memberText;
	memberKeys = memberKeys + "|" + memberKey;
	values = values + "|" + value;
  }
});

memberKeys = memberKeys.substring(1);
memberTexts = memberTexts.substring(1);
values = values.substring(1);

COLLECTION_1.setItems(memberKeys, memberTexts, values, "|");
COLLECTION_1.sortByValueDescending();

// var labelsAsArray = COLLECTION_1.getLabelsAsSingleMemberFilterArray();
var keysAndlabelsAsArray = COLLECTION_1.getAsKeyLabelValueArray(5);

CHART_1.setDataSelection({
// 	"0BC_PERS1":labelsAsArray
});

LISTBOX_1.removeAllItems();

keysAndlabelsAsArray.forEach(function(element, index) {
  LISTBOX_1.addItem(element.key, element.label + "( " + element.value + " )");
});

// COLLECTION_1.sortByKey(org.kalisz.karol.scn.pack.SortDirection.ASCENDING);]]></bi:value>
			</bi:property>
		</bi:component>
		<bi:component name="BUTTON_3" type="BUTTON_COMPONENT">
			<bi:property name="TEXT" value="Print All Methods"/>
			<bi:property name="LEFT_MARGIN" value="798"/>
			<bi:property name="TOP_MARGIN" value="43"/>
			<bi:property name="WIDTH" value="200"/>
			<bi:property name="ON_CLICK">
				<bi:value><![CDATA[LISTBOX_1.addItem("start", "print out methods");

var int = 0;
LISTBOX_1.addItem("v" + int, ""+ COLLECTION_1.getKeys("|"));
int = int + 1;
LISTBOX_1.addItem("v" + int, ""+ COLLECTION_1.getLabels("|"));
int = int + 1;
LISTBOX_1.addItem("v" + int, ""+ COLLECTION_1.getValues("|"));
int = int + 1;

LISTBOX_1.addItem("v" + int, ""+ COLLECTION_1.getLength());
int = int + 1;

LISTBOX_1.addItem("v" + int, ""+ COLLECTION_1.getLabelByKey("00006"));
int = int + 1;
LISTBOX_1.addItem("v" + int, ""+ COLLECTION_1.getValueByKey("00006"));
int = int + 1;
LISTBOX_1.addItem("v" + int, ""+ COLLECTION_1.getValueByKeyAsString("00006"));
int = int + 1;

LISTBOX_1.addItem("v" + int, ""+ COLLECTION_1.getValueByIndex(6));
int = int + 1;

LISTBOX_1.addItem("v" + int, ""+ COLLECTION_1.getValueByIndexAsString(6));
int = int + 1;

COLLECTION_1.addItem("KAROL", "LAST", "100");

LISTBOX_1.addItem("v" + int, ""+ COLLECTION_1.getValueByKeyAsString("KAROL"));
int = int + 1;

]]></bi:value>
			</bi:property>
		</bi:component>
		<bi:component name="LISTBOX_1" type="LISTBOX_COMPONENT">
			<bi:property name="LEFT_MARGIN" value="384"/>
			<bi:property name="TOP_MARGIN" value="109"/>
			<bi:property name="WIDTH" value="300"/>
			<bi:property name="HEIGHT" value="400"/>
		</bi:component>
		<bi:component name="CHART_1" type="CHART_COMPONENT">
			<bi:property name="LEFT_MARGIN" value="688"/>
			<bi:property name="TOP_MARGIN" value="179"/>
			<bi:property name="DATA_SOURCE_ALIAS_REF" value="DS_1"/>
		</bi:component>
	</bi:component>
</bi:biapp>
