<bi:biapp bi:version="1302" xmlns:bi="http://xml.sap.com/2011/biml/biapp" xmlns:jsp="http://java.sun.com/JSP/Page" xmlns="http://www.w3.org/TR/REC-html40" xmlns:h="http://www.w3.org/TR/REC-html40" xmlns:sdk1="org.kalisz.karol.scn.pack" sdk1:version="1.0">
	<bi:component name="APPLICATION_PROPERTIES" type="APPLICATION_PROPERTIES">
		<bi:property name="THEME" value="sap_platinum"/>
		<bi:property name="MESSAGE_TYPES" value="ALL"/>
	</bi:component>
	<bi:data_source_alias name="DS_1" type="QUERY_DATA_SOURCE">
		<bi:property name="DATA_SOURCE_DEFINITION">
			<bi:property name="DATA_SOURCE_CONNECTION" value="Q93 [PUBLIC]"/>
			<bi:property name="DATA_SOURCE_TYPE" type="CHOICE" value="QUERY"/>
			<bi:property name="DATA_SOURCE_NAME" value="0BICS_009_BICSTEST_Q0007"/>
			<bi:property name="DATA_SOURCE_INITIAL_STATE">
				<bi:value><![CDATA[eNrtWm1v4jgQ/iuI76fQQtWrlI1knAn41olT2wHS08niWm4P6ZaeWvbD3a+/ySsJDRRaet2tUqEq9tjj8TzP2DMEe8ioMhMGU8dWICeMgnFBUclCzUSAnbHS4BvCGVHO9VW/82sYDTmjv9lWTWS7RBNDJBDHBY9EXNvWputwNdcRyNjppWb1elcmedCgtLnu9XqXtpXJcVaTsSzwhAmlmDAXZGc1/7r41C1Vda1c+7Zga40u7iVCxUSDc947G/Suzs5xL0VXaYICDjRZ16iQoCVKSM2CUWf9z9+oPXdCsmhloEYNBw+sdORjKZFoJyNBskk3ohptpWMiCdUgmdK4j+2OcrPUhCDVWbeiVeGaVn34vum45AunD7zpz3QQXvUH04t+n19MB0H/lwsigmfVWU+2Z5UTqs+Fx47wRr6dCVMRcu+GpGo4TIBvGNwktInWkg0jRKLyXNFMBX+RXh/8IUhDKAWFqkMJCgKdDtlqOhpmqKXWVW/ihGaapYqwwQJwTbaiMkJivKD7XSZz1xJFIXBxOjK/7ER/ZzrxacvYCig1Mzq/L1d3y9WXT93ahITtVSBppLTwTYhY+YBgJVxANWiwUaBf74sNZMnCVc1WKWoGcyRF1KL5UdD0iW7B/ChghpLRt0bTZSrkJDafIW5BPdolL8d2CmzUYvvjY2tVk6Wa2Z2v93foy6EQn9F7E8IjUN03sK7y7BSnRjP9nOK+3yPG3G6PFK+XPdKE07ud871TrI73M3wbM5BE0nHcufu2cOfrJKrzv24e5d0aLXewIR+Akc6GjDMdO+kjh5JxFdFhWzkR498Wrlo4vbrEavOdVx6fR9O5iblj5roQnIy47+/36nY9If2Ik0IdKqIC7WCBSiLLY6MIRzvrh28L5HODxL4BKYyKwmQHKmFichCHyULZpN3yY77CyL8BOX3NT0bQpisfMxUdCx/aQ/SjFI2K8DZQP2Cg0khKCGjcRuqPGKknLRObzDp9HZlcC3uKPUwIdkkLqu6ZjadUWyl+Z5Xi29DqfUvJp6/XmjByJePcuGIamK3xu99lZues2X73iXWCqVp04jec7/GK8pXvW595w3mgH8ksPaFmTOUGSDFNGFyGFwpx/gScP+Z/PWI9lbdybLN7sIccqjRtqzJbxT7yQTJqsiG+cEtdjbIiIkOhWLqXodDIrJKQZf/T0i+dH4gAGsq+TPeTbvykvzbAGJMx/icY+W7WRYFztauKfHbec+xzSqRfGl1WgloNOyp45AfN8GX7aELvvEXvePR2hv3p0PQkQBuJ/1ckJjfAK7GzssN0s3TncfllFT4sHher9Xy9vF9h+gF4AoMJouRe7nb+XTzc1wcEQvppqVmqKRLbMsPt3P45f5jfrhcPy8f18nbfHVS7pKYzvz+O+PXAP4tDT19egZdm9aV6FyjDxZXzE7qibNiKYuETjIyHjhAyFW512eCHY6LYDbgFoyo9tmKjAG+dCS5CeEm5WieurQnjBvXSiGfZT8afBkHDYLNJYjY/I9s3CoH0C325RZUem4Qhj02DBi3y+1OVcXjA0Fxf8m0n5olHqD1oRhGoT53XIGhmcIVtpyaeDPqXI94b9APv/Fzoa28W835LvJZ428Szaod2XuwaLUmgMhV5CVev60yCteHMZzq5/poF+SUpMOEiRUYNMwph0aACi6Ey1978uPU/qhxyFg==]]></bi:value>
			</bi:property>
		</bi:property>
	</bi:data_source_alias>
	<bi:component name="ROOT" type="ABSOLUTE_LAYOUT_COMPONENT">
		<bi:component name="COLLECTION_1" type="org_kalisz_karol_scn_pack_Collection"/>
		<bi:component name="CROSSTAB_1" type="CROSSTAB_COMPONENT">
			<bi:property name="LEFT_MARGIN" value="24"/>
			<bi:property name="TOP_MARGIN" value="106"/>
			<bi:property name="DATA_SOURCE_ALIAS_REF" value="DS_1"/>
			<bi:property name="HEIGHT" value="656"/>
			<bi:property name="WIDTH" value="475"/>
		</bi:component>
		<bi:component name="DIMENSIONFILTER_1" type="DIMENSIONFILTER_COMPONENT">
			<bi:property name="LEFT_MARGIN" value="27"/>
			<bi:property name="TOP_MARGIN" value="3"/>
			<bi:property name="DATA_SOURCE_ALIAS_REF" value="DS_1"/>
			<bi:property name="DIMENSION_NAME" value="0BC_PERS1"/>
		</bi:component>
		<bi:component name="BUTTON_1" type="BUTTON_COMPONENT">
			<bi:property name="TEXT" value="Get Leaders &amp; Loosers"/>
			<bi:property name="LEFT_MARGIN" value="24"/>
			<bi:property name="TOP_MARGIN" value="46"/>
			<bi:property name="WIDTH" value="226"/>
			<bi:property name="ON_CLICK">
				<bi:value><![CDATA[var allMembers = DS_1.getMembers("0BC_PERS1", 9999);

COLLECTION_1.removeAllItems();

allMembers.forEach(function(member, index) {
  var memberKey = member.internalKey;
  var memberText = member.text;
  
  var dataCell = DS_1.getData("4FW8C4WXM3HULQ4M1YPFT79EF", {
  	"0BC_PERS1": memberKey
  });
  
  if(dataCell.formattedValue != "") {
	var value = dataCell.value;
	var formattedValue = dataCell.formattedValue;
	
	COLLECTION_1.addItem(memberKey, memberText, value, formattedValue);
  }
});

// leaders
COLLECTION_1.sortByValueDescending();
var keysAndlabelsAsArray = COLLECTION_1.getAsKeyLabelValueExtendedArray(5);

LEADERBOARD.removeAllElements();

keysAndlabelsAsArray.forEach(function(element, index) {
	LEADERBOARD.addElement(element.key, element.label + " ("+element.key+")", element.key + ".jpg", element.value, "" + element.param1);
});

// leaders
COLLECTION_1.sortByValue();
keysAndlabelsAsArray = COLLECTION_1.getAsKeyLabelValueExtendedArray(5);

LOOSERBOARD.removeAllElements();


keysAndlabelsAsArray.forEach(function(element, index) {
	LOOSERBOARD.addElement(element.key, element.label + " ("+element.key+")", element.key + ".jpg", element.value, "" + element.param1);
});]]></bi:value>
			</bi:property>
		</bi:component>
		<bi:component name="LEADERBOARD" type="org_kalisz_karol_scn_pack_LeaderBoard">
			<bi:property name="LEFT_MARGIN" value="401"/>
			<bi:property name="TOP_MARGIN" value="131"/>
			<bi:property name="HEIGHT" value="225"/>
			<bi:property name="valueSuffix" value=" Points"/>
			<bi:property name="fallbackPicture" value="NoName.png"/>
		</bi:component>
		<bi:component name="TEXT_2" type="TEXT_COMPONENT">
			<bi:property name="TEXT" value="Leaders"/>
			<bi:property name="LEFT_MARGIN" value="401"/>
			<bi:property name="TOP_MARGIN" value="104"/>
			<bi:property name="STYLE" value="HEADING1"/>
		</bi:component>
		<bi:component name="LOOSERBOARD" type="org_kalisz_karol_scn_pack_LeaderBoard">
			<bi:property name="LEFT_MARGIN" value="401"/>
			<bi:property name="TOP_MARGIN" value="410"/>
			<bi:property name="HEIGHT" value="225"/>
			<bi:property name="valueSuffix" value=" Points"/>
			<bi:property name="fallbackPicture" value="NoName.png"/>
		</bi:component>
		<bi:component name="TEXT_1" type="TEXT_COMPONENT">
			<bi:property name="TEXT" value="Loosers"/>
			<bi:property name="LEFT_MARGIN" value="401"/>
			<bi:property name="TOP_MARGIN" value="382"/>
			<bi:property name="STYLE" value="HEADING1"/>
		</bi:component>
	</bi:component>
</bi:biapp>
